(()=>{var I=Object.defineProperty;var v=n=>{throw TypeError(n)};var C=(n,t,e)=>t in n?I(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var r=(n,t,e)=>C(n,typeof t!="symbol"?t+"":t,e),p=(n,t,e)=>t.has(n)||v("Cannot "+e);var L=(n,t,e)=>(p(n,t,"read from private field"),e?e.call(n):t.get(n)),E=(n,t,e)=>t.has(n)?v("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),T=(n,t,e,o)=>(p(n,t,"write to private field"),o?o.call(n,e):t.set(n,e),e),l=(n,t,e)=>(p(n,t,"access private method"),e);var h="nunsez-video-bookmarklet";var D="".concat(h,"-memory"),i="".concat(h,"-controller"),M="".concat(h,"-tickmarks"),S="".concat(h,"-stylesheet"),R="#".concat(i," * {box-sizing: border-box;color: #111;line-height:initial}")+"#".concat(i,", #").concat(i," .range, #").concat(i," .controls {margin: 0;padding: 4px;}")+"#".concat(i,", #").concat(i," .btn {border: 1px solid #444;border-radius: 4px;background-color: #eee;}")+"#".concat(i," {position: fixed;left: 8px;top: 8px;width: 150px;font: 15px monospace;box-shadow: 1px 1px 4px #444;user-select: none;z-index: 999999999;}")+"#".concat(i," .controls {display: flex;justify-content: space-between;align-items: center;}")+"#".concat(i," .btn {width: 20px;height: 20px;margin: 0;padding: 0;}")+"#".concat(i," .value {pointer-events: none;}")+"#".concat(i,' .value::after {content: "%";margin-left: 2px;}')+"#".concat(i," .range {width: 100%;}")+"#".concat(i," .range ~ * {display: none;}");function N(n){if(n.head.querySelector("#".concat(S)))return;let t=n.createElement("style");t.setAttribute("id",S),t.textContent=R,n.head.append(t)}var c,d=class d{constructor(t){r(this,"document");r(this,"speed");r(this,"videos",[]);r(this,"oldController");E(this,c,null);this.document=t,this.speed=100,this.oldController=t.querySelector(i)}static getSpeed(){let t=Number.parseInt(localStorage.getItem(D)||"");return Number.isNaN(t)?100:t}static getVideos(t){let e=[];return t.querySelectorAll("video, iframe").forEach(o=>{var u;if(o instanceof HTMLVideoElement)e.push(o);else if(o instanceof HTMLIFrameElement){let a=(u=d.getIDoc(o))==null?void 0:u.querySelector("video");a&&e.push(a)}}),e}static getIDoc(t){var e;try{return((e=t.contentWindow)==null?void 0:e.document)||t.contentDocument}catch(o){return console.log("iframe document is not reachable: "+t.src),null}}initialize(t){this.videos=d.getVideos(document.body),this.speed=d.getSpeed()}get controller(){return L(this,c)}set controller(t){T(this,c,t)}setSpeed(t){if(Number.isNaN(t))return;t===5?this.speed>5?this.speed=0:this.speed=10:t>300?this.speed=300:t<0?this.speed=0:this.speed=t;let e=this.speed.toString();this.controller.value.textContent=e,this.controller.range.value=e,this.videos.forEach(o=>o.playbackRate=this.speed/100),localStorage.setItem(D,e)}};c=new WeakMap;var b=d,s,f,x,y,H,B,$,A,k,m=class m{constructor(t){E(this,s);r(this,"state");r(this,"el");r(this,"subBtn",document.createElement("button"));r(this,"value",document.createElement("div"));r(this,"addBtn",document.createElement("button"));r(this,"range",document.createElement("input"));this.state=t,this.el=document.createElement("div")}append(t){var e;return(e=t.querySelector(i))==null||e.remove(),l(this,s,x).call(this),l(this,s,f).call(this),t.append(this.el),this}};s=new WeakSet,f=function(){this.range.addEventListener("input",()=>{let t=Number.parseFloat(this.range.value);this.state.setSpeed(t)}),this.subBtn.addEventListener("click",()=>this.state.setSpeed(this.state.speed-5)),this.addBtn.addEventListener("click",()=>this.state.setSpeed(this.state.speed+5))},x=function(){this.el.setAttribute("id",i),this.el.append(l(this,s,y).call(this),l(this,s,A).call(this),l(this,s,k).call(this,m.tickMarks))},y=function(){let t=document.createElement("div");return t.classList.add("controls"),t.append(l(this,s,H).call(this),l(this,s,B).call(this),l(this,s,$).call(this)),t},H=function(){return this.subBtn=document.createElement("button"),this.subBtn.textContent="-",this.subBtn.classList.add("btn","sub"),this.subBtn},B=function(){return this.value=document.createElement("div"),this.value},$=function(){return this.addBtn=document.createElement("button"),this.addBtn.textContent="+",this.addBtn.classList.add("btn","add"),this.addBtn},A=function(){return this.range=document.createElement("input"),this.range.classList.add("range"),this.range.setAttribute("type","range"),this.range.setAttribute("min","10"),this.range.setAttribute("max","300"),this.range.setAttribute("step","10"),this.range.setAttribute("list",M),this.range},k=function(t){let e=document.createElement("datalist");e.setAttribute("id",M);let o=t.map(u=>{let a=document.createElement("option");return a.value=u.toString(),a});return e.append(...o),e},r(m,"tickMarks",[10,50,100,150,200,250,300]);var g=m;function F(n){let t=new b(n);if(t.initialize([]),t.videos.length===0){alert("Sorry, i can't find any html5 videos :(");return}if(t.oldController){t.oldController.remove(),t.videos.forEach(o=>o.playbackRate=100/100);return}N(n),new MutationObserver(t.initialize).observe(n.body,{childList:!0}),t.controller=new g(t),t.controller.append(n.body)}F(document);})();
/**
 * @file A script to control the speed of html5 video playback in the browser.
 * @author Alexander Mandrikov <mad.nunsez@gmail.com>
 * @version 2.0.0
 * @license AGPLv3
 * @see {@link https://github.com/nunsez/bookmarklet-video-speed GitHub} for further information.
 */
